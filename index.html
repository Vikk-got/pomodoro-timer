<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aesthetic Pomodoro Timer</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap');

        :root {
            --primary-color: #ffffff;
            --secondary-color: #f0f0f0;
            --accent-color: #3e4889;
            --text-color: #333;
            --shadow-color: rgba(0, 0, 0, 0.1);
            --completed-color: #a9a9a9;
            --light-accent-color: #fdecec;
        }

        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: var(--secondary-color);
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            transition: background-image 0.5s ease-in-out;
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            background-color: var(--primary-color);
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 10px 30px var(--shadow-color);
            width: 90%;
            max-width: 500px;
            text-align: center;
        }

        .timer-modes button {
            background: none;
            border: none;
            font-size: 1rem;
            cursor: pointer;
            padding: 0.5rem 1rem;
            margin: 0 0.5rem;
            color: var(--text-color);
            opacity: 0.7;
            transition: opacity 0.3s;
        }

        .timer-modes button.active {
            opacity: 1;
            font-weight: 600;
            border-bottom: 2px solid var(--accent-color);
        }

        .timer {
            font-size: 5rem;
            font-weight: 700;
            margin: 2rem 0;
        }

        .timer-controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
        }

        .timer-controls button {
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 25px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        #start-stop-btn {
            background-color: var(--accent-color);
        }
        #start-stop-btn:hover {
            background-color: #867575;
        }
        #reset-btn {
            background-color: #ccc;
        }
        #reset-btn:hover {
            background-color: #bbb;
        }

        .goals {
            margin-top: 2rem;
        }
        
        .goals h2 {
            margin-bottom: 1rem;
        }

        #goal-input {
            width: calc(70% - 10px);
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        #add-goal-btn {
            padding: 0.5rem 1rem;
            border: none;
            background-color: var(--accent-color);
            color: white;
            border-radius: 5px;
            cursor: pointer;
            margin-left: 5px;
        }
        
        #goal-list {
            list-style: none;
            padding: 0;
            margin-top: 1rem;
            text-align: left;
        }

        #goal-list li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem;
            border-bottom: 1px solid #ddd;
            word-break: break-all;
        }

        #goal-list li.completed span {
            text-decoration: line-through;
            color: var(--completed-color);
        }
        
        #goal-list li .goal-content {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        #goal-list li input[type="checkbox"] {
            cursor: pointer;
        }

        #goal-list li .delete-btn {
            background: none;
            border: none;
            cursor: pointer;
            color: #ff6b6b;
            font-size: 1rem;
            padding: 5px;
        }

        .settings, .background-upload {
            margin-top: 2rem;
        }

        #settings-toggle-btn {
            background: none;
            border: 1px solid var(--accent-color);
            color: var(--accent-color);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background-color 0.3s, color 0.3s;
        }
        #settings-toggle-btn:hover {
            background-color: var(--accent-color);
            color: white;
        }

        .settings-form {
            background-color: var(--light-accent-color);
            padding: 1.5rem;
            border-radius: 10px;
            margin-top: 1rem;
            display: none; /* Initially hidden */
            flex-wrap: wrap;
            justify-content: space-around;
            gap: 1rem;
            align-items: center;
            animation: fadeIn 0.5s;
        }

        .settings-form.visible {
            display: flex; /* Show when class is added */
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .settings-form div {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .settings-form label {
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .settings-form input {
            width: 60px;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            text-align: center;
        }

        #save-settings-btn {
            background-color: var(--accent-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            border: none;
            width: 100%;
            margin-top: 1rem;
        }
        
        .upload-label {
            background-color: var(--accent-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
        }

        input[type="file"] {
            display: none;
        }
        
        @media (max-width: 480px) {
            .timer {
                font-size: 4rem;
            }
            .timer-controls button {
                padding: 0.8rem 1.5rem;
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Pomodoro Timer</h1>

        <div class="timer-modes">
            <button id="pomodoro-btn" class="active">Pomodoro</button>
            <button id="short-break-btn">Short Break</button>
            <button id="long-break-btn">Long Break</button>
        </div>

        <div class="timer" id="timer-display">25:00</div>

        <div class="timer-controls">
            <button id="start-stop-btn">Start</button>
            <button id="reset-btn">Reset</button>
        </div>
        
        <div class="settings">
            <button id="settings-toggle-btn">Settings</button>
            <div id="settings-form" class="settings-form">
                <div>
                    <label for="pomodoro-duration">Pomodoro (min)</label>
                    <input type="number" id="pomodoro-duration" value="25" min="1">
                </div>
                <div>
                    <label for="short-break-duration">Short Break (min)</label>
                    <input type="number" id="short-break-duration" value="5" min="1">
                </div>
                <div>
                    <label for="long-break-duration">Long Break (min)</label>
                    <input type="number" id="long-break-duration" value="15" min="1">
                </div>
                 <button id="save-settings-btn">Save & Apply</button>
            </div>
        </div>

        <div class="goals">
            <h2>My Goals</h2>
            <input type="text" id="goal-input" placeholder="Add a new goal">
            <button id="add-goal-btn">Add</button>
            <ul id="goal-list"></ul>
        </div>

        <div class="background-upload">
            <label for="background-input" class="upload-label">Change Background</label>
            <input type="file" id="background-input" accept="image/*">
        </div>
    </div>

    <script>
        // DOM Elements
        const timerDisplay = document.getElementById('timer-display');
        const startStopBtn = document.getElementById('start-stop-btn');
        const resetBtn = document.getElementById('reset-btn');
        const pomodoroBtn = document.getElementById('pomodoro-btn');
        const shortBreakBtn = document.getElementById('short-break-btn');
        const longBreakBtn = document.getElementById('long-break-btn');
        const goalInput = document.getElementById('goal-input');
        const addGoalBtn = document.getElementById('add-goal-btn');
        const goalList = document.getElementById('goal-list');
        const backgroundInput = document.getElementById('background-input');
        const settingsToggleBtn = document.getElementById('settings-toggle-btn');
        const settingsForm = document.getElementById('settings-form');
        const pomodoroDurationInput = document.getElementById('pomodoro-duration');
        const shortBreakDurationInput = document.getElementById('short-break-duration');
        const longBreakDurationInput = document.getElementById('long-break-duration');
        const saveSettingsBtn = document.getElementById('save-settings-btn');
        
        // Timer state
        let minutes;
        let seconds = 0;
        let timerInterval;
        let isRunning = false;
        let currentMode = 'pomodoro';
        
        // Timer durations
        let pomodoroDuration = 25;
        let shortBreakDuration = 5;
        let longBreakDuration = 15;

        // Load data from local storage on startup
        document.addEventListener('DOMContentLoaded', () => {
            loadSettings();
            loadGoals();
            loadBackground();
            const savedMode = localStorage.getItem('pomodoroMode') || 'pomodoro';
            switchMode(savedMode);
        });

        // Timer Functions
        function startTimer() {
            if (isRunning) return;
            isRunning = true;
            startStopBtn.textContent = 'Pause';
            timerInterval = setInterval(updateTimer, 1000);
        }

        function stopTimer() {
            isRunning = false;
            startStopBtn.textContent = 'Start';
            clearInterval(timerInterval);
        }

        function resetTimer() {
            stopTimer();
            switch (currentMode) {
                case 'pomodoro': minutes = pomodoroDuration; break;
                case 'shortBreak': minutes = shortBreakDuration; break;
                case 'longBreak': minutes = longBreakDuration; break;
            }
            seconds = 0;
            updateDisplay();
            document.title = "Aesthetic Pomodoro Timer";
        }

        function updateTimer() {
            if (seconds === 0) {
                if (minutes === 0) {
                    stopTimer();
                    alert('Time is up!');
                    document.title = "Time's Up!";
                    return;
                }
                minutes--;
                seconds = 59;
            } else {
                seconds--;
            }
            updateDisplay();
        }

        function updateDisplay() {
            const timeString = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            timerDisplay.textContent = timeString;
            document.title = `${timeString} - ${currentMode.charAt(0).toUpperCase() + currentMode.slice(1).replace('B', ' B')}`;
        }

        function switchMode(mode) {
            currentMode = mode;
            localStorage.setItem('pomodoroMode', mode);
            document.querySelectorAll('.timer-modes button').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`${mode.replace('B','-b')}-btn`).classList.add('active');
            resetTimer();
        }

        // Settings Functions
        function toggleSettings() {
            settingsForm.classList.toggle('visible');
        }
        
        function saveSettings() {
            pomodoroDuration = parseInt(pomodoroDurationInput.value) || 25;
            shortBreakDuration = parseInt(shortBreakDurationInput.value) || 5;
            longBreakDuration = parseInt(longBreakDurationInput.value) || 15;

            localStorage.setItem('pomodoroSettings', JSON.stringify({
                pomodoro: pomodoroDuration,
                shortBreak: shortBreakDuration,
                longBreak: longBreakDuration
            }));
            
            alert('Settings saved!');
            switchMode(currentMode); // Reset timer with new values
        }

        function loadSettings() {
            const savedSettings = JSON.parse(localStorage.getItem('pomodoroSettings'));
            if (savedSettings) {
                pomodoroDuration = savedSettings.pomodoro;
                shortBreakDuration = savedSettings.shortBreak;
                longBreakDuration = savedSettings.longBreak;
                
                pomodoroDurationInput.value = pomodoroDuration;
                shortBreakDurationInput.value = shortBreakDuration;
                longBreakDurationInput.value = longBreakDuration;
            }
        }

        // Event Listeners for Timer and Settings
        startStopBtn.addEventListener('click', () => isRunning ? stopTimer() : startTimer());
        resetBtn.addEventListener('click', resetTimer);
        settingsToggleBtn.addEventListener('click', toggleSettings);
        saveSettingsBtn.addEventListener('click', saveSettings);
        pomodoroBtn.addEventListener('click', () => switchMode('pomodoro'));
        shortBreakBtn.addEventListener('click', () => switchMode('shortBreak'));
        longBreakBtn.addEventListener('click', () => switchMode('longBreak'));

        // Goal Functions
        function getGoals() {
            return JSON.parse(localStorage.getItem('pomodoroGoals')) || [];
        }

        function saveGoals(goals) {
            localStorage.setItem('pomodoroGoals', JSON.stringify(goals));
        }

        function addGoal() {
            const goalText = goalInput.value.trim();
            if (goalText) {
                const goals = getGoals();
                goals.push({ text: goalText, completed: false });
                saveGoals(goals);
                renderGoals();
                goalInput.value = '';
            }
        }
        
        window.toggleGoal = function(index) {
            const goals = getGoals();
            goals[index].completed = !goals[index].completed;
            saveGoals(goals);
            renderGoals();
        }

        window.removeGoal = function(index) {
            const goals = getGoals();
            goals.splice(index, 1);
            saveGoals(goals);
            renderGoals();
        }

        function renderGoals() {
            goalList.innerHTML = '';
            const goals = getGoals();
            goals.forEach((goal, index) => {
                const li = document.createElement('li');
                li.className = goal.completed ? 'completed' : '';
                li.innerHTML = `
                    <div class="goal-content">
                        <input type="checkbox" onclick="toggleGoal(${index})" ${goal.completed ? 'checked' : ''}>
                        <span>${goal.text}</span>
                    </div>
                    <button class="delete-btn" onclick="removeGoal(${index})">X</button>
                `;
                goalList.appendChild(li);
            });
        }

        function loadGoals() {
            renderGoals();
        }

        addGoalBtn.addEventListener('click', addGoal);
        goalInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') addGoal();
        });

        // Background Image Functions
        function handleBackgroundUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const imageUrl = e.target.result;
                    document.body.style.backgroundImage = `url(${imageUrl})`;
                    localStorage.setItem('pomodoroBackground', imageUrl);
                };
                reader.readAsDataURL(file);
            }
        }

        function loadBackground() {
            const savedBackground = localStorage.getItem('pomodoroBackground');
            if (savedBackground) {
                document.body.style.backgroundImage = `url(${savedBackground})`;
            }
        }

        backgroundInput.addEventListener('change', handleBackgroundUpload);
    </script>
</body>
</html>