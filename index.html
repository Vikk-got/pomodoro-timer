<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>FocusFlow - Pomodoro & Task Manager</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com "></script>
  <style>
    body {
      background-image: url('original-79e2b38783f69d403129674f6f5d73c3.gif');
      background-size: cover;
      background-position: center;
      transition: background-image 0.5s ease-in-out;
    }
  </style>
</head>
<body class="min-h-screen bg-cover bg-center flex items-center justify-center p-4 text-white">

  <div class="bg-black bg-opacity-70 backdrop-blur-md rounded-xl shadow-2xl p-4 sm:p-6 w-full max-w-3xl space-y-6">
    <h1 class="text-3xl sm:text-4xl font-extrabold text-center mb-4 tracking-wide">FocusFlow</h1>

    <!-- Pomodoro Timer -->
    <section id="pomodoro-section" class="bg-gray-900 p-4 sm:p-5 rounded-lg shadow-lg">
      <h2 class="text-xl sm:text-2xl font-semibold mb-3">Pomodoro Timer</h2>
      <div class="flex items-center gap-2 mb-3">
        <input id="work-minutes" type="number" min="1" value="25" class="w-16 sm:w-20 px-2 py-1 rounded bg-gray-800 text-white focus:outline-none" />
        <span>Minutes</span>
      </div>
      <div id="work-timer" class="text-4xl sm:text-5xl font-mono text-center my-4">25:00</div>
      <div class="flex flex-wrap justify-center gap-2">
        <button onclick="startWork()" class="px-3 py-1 sm:px-4 sm:py-2 bg-green-500 hover:bg-green-600 text-white rounded transition">Start</button>
        <button onclick="pauseWork()" class="px-3 py-1 sm:px-4 sm:py-2 bg-yellow-500 hover:bg-yellow-600 text-white rounded transition">Pause</button>
        <button onclick="resetWork()" class="px-3 py-1 sm:px-4 sm:py-2 bg-red-500 hover:bg-red-600 text-white rounded transition">Reset</button>
      </div>
    </section>

    <!-- Break Timer -->
    <section id="break-section" class="bg-gray-900 p-4 sm:p-5 rounded-lg shadow-lg">
      <h2 class="text-xl sm:text-2xl font-semibold mb-3">Break Timer</h2>
      <div class="flex items-center gap-2 mb-3">
        <input id="break-minutes" type="number" min="1" value="5" class="w-16 sm:w-20 px-2 py-1 rounded bg-gray-800 text-white focus:outline-none" />
        <span>Minutes</span>
      </div>
      <div id="break-timer" class="text-4xl sm:text-5xl font-mono text-center my-4">05:00</div>
      <div class="flex flex-wrap justify-center gap-2">
        <button onclick="startBreak()" class="px-3 py-1 sm:px-4 sm:py-2 bg-green-500 hover:bg-green-600 text-white rounded transition">Start</button>
        <button onclick="pauseBreak()" class="px-3 py-1 sm:px-4 sm:py-2 bg-yellow-500 hover:bg-yellow-600 text-white rounded transition">Pause</button>
        <button onclick="resetBreak()" class="px-3 py-1 sm:px-4 sm:py-2 bg-red-500 hover:bg-red-600 text-white rounded transition">Reset</button>
      </div>
    </section>

    <!-- Lofi Music Player -->
    <section id="lofi-section" class="bg-gray-900 p-4 sm:p-5 rounded-lg shadow-lg">
      <h2 class="text-xl sm:text-2xl font-semibold mb-3">Lofi Playlist</h2>
      <div id="now-playing" class="text-center text-sm text-gray-400 mb-3 italic">
        No song selected
      </div>
      <ul id="lofi-playlist" class="space-y-2 max-h-60 overflow-y-auto pr-1"></ul>
      <audio id="lofi-player" class="mt-4 w-full hidden"></audio>
    </section>

    <!-- Background Upload -->
    <section class="bg-gray-900 p-4 sm:p-5 rounded-lg shadow-lg">
      <h2 class="text-xl sm:text-2xl font-semibold mb-3">Change Background</h2>
      <input id="bg-upload" type="file" accept="image/*" class="text-sm text-white file:mr-4 file:py-1 file:px-3 file:border-0 file:text-sm file:font-semibold file:bg-blue-600 file:hover:bg-blue-700 file:text-white rounded-md cursor-pointer" />
    </section>

    <!-- To-Do List -->
    <section class="bg-gray-900 p-4 sm:p-5 rounded-lg shadow-lg">
      <h2 class="text-xl sm:text-2xl font-semibold mb-3">To-Do List</h2>
      <div class="flex flex-col sm:flex-row items-start sm:items-center gap-2 mb-4">
        <input id="new-task" type="text" placeholder="Add a new task..." class="flex-grow px-4 py-2 rounded bg-gray-800 text-white focus:outline-none w-full sm:w-auto" />
        <button onclick="addTask()" class="px-4 py-2 bg-indigo-600 hover:bg-indigo-700 rounded transition w-full sm:w-auto">Add</button>
      </div>
      <ul id="task-list" class="space-y-2 max-h-60 overflow-y-auto pr-1"></ul>
    </section>

    <footer class="text-center text-xs sm:text-sm text-gray-400 mt-6">
      FocusFlow © <span id="year"></span> | Stay Focused. Stay Productive.
    </footer>
  </div>

<script>
  // ========== TIMER LOGIC ==========
  let workTimerInterval = null;
  let breakTimerInterval = null;

  // Load saved values or defaults
  let timeLeft = localStorage.getItem("workTime") 
    ? parseInt(localStorage.getItem("workTime")) 
    : 25 * 60;
  let breakLeft = localStorage.getItem("breakTime") 
    ? parseInt(localStorage.getItem("breakTime")) 
    : 5 * 60;

  function formatTime(seconds) {
    const mins = Math.floor(seconds / 60).toString().padStart(2, '0');
    const secs = (seconds % 60).toString().padStart(2, '0');
    return `${mins}:${secs}`;
  }

  function updateWorkDisplay() {
    document.getElementById("work-timer").textContent = formatTime(timeLeft);
    localStorage.setItem("workTime", timeLeft);
  }

  function updateBreakDisplay() {
    document.getElementById("break-timer").textContent = formatTime(breakLeft);
    localStorage.setItem("breakTime", breakLeft);
  }

  function startWork() {
    if (!workTimerInterval) {
      workTimerInterval = setInterval(() => {
        if (timeLeft > 0) {
          timeLeft--;
          updateWorkDisplay();
        } else {
          clearInterval(workTimerInterval);
          workTimerInterval = null;
          alert("Pomodoro session complete! Time for a break.");
        }
      }, 1000);
    }
  }

  function pauseWork() {
    clearInterval(workTimerInterval);
    workTimerInterval = null;
  }

  function resetWork() {
    pauseWork();
    timeLeft = parseInt(document.getElementById("work-minutes").value) * 60;
    updateWorkDisplay();
  }

  function startBreak() {
    if (!breakTimerInterval) {
      breakTimerInterval = setInterval(() => {
        if (breakLeft > 0) {
          breakLeft--;
          updateBreakDisplay();
        } else {
          clearInterval(breakTimerInterval);
          breakTimerInterval = null;
          alert("Break is over! Back to focus!");
        }
      }, 1000);
    }
  }

  function pauseBreak() {
    clearInterval(breakTimerInterval);
    breakTimerInterval = null;
  }

  function resetBreak() {
    pauseBreak();
    breakLeft = parseInt(document.getElementById("break-minutes").value) * 60;
    updateBreakDisplay();
  }

  // ========== BACKGROUND UPLOAD ==========
  document.getElementById("bg-upload").addEventListener("change", function(e) {
    const file = e.target.files[0];
    const reader = new FileReader();
    reader.onload = function(event) {
      document.body.style.backgroundImage = `url('${event.target.result}')`;
      localStorage.setItem("backgroundImage", event.target.result);
    };
    reader.readAsDataURL(file);
  });

  // Load saved background
  const savedBg = localStorage.getItem("backgroundImage");
  if (savedBg) {
    document.body.style.backgroundImage = `url('${savedBg}')`;
  }

  // ========== TASK LIST LOGIC ==========
  function saveTasks() {
    const tasks = [];
    document.querySelectorAll("#task-list li").forEach(li => {
      const text = li.querySelector("span").textContent;
      const completed = li.querySelector("input").checked;
      tasks.push({ text, completed });
    });
    localStorage.setItem("tasks", JSON.stringify(tasks));
  }

  function addTask(text = null, completed = false) {
    const input = document.getElementById("new-task");
    const taskText = text || input.value.trim();
    if (!taskText) return;

    const list = document.getElementById("task-list");

    const li = document.createElement("li");
    li.className = "flex items-center justify-between p-2 sm:p-3 rounded-md bg-gray-800";

    const label = document.createElement("label");
    label.className = "flex items-center gap-2 cursor-pointer";

    const checkbox = document.createElement("input");
    checkbox.type = "checkbox";
    checkbox.className = "form-checkbox h-4 w-4 sm:h-5 sm:w-5 text-blue-500";
    checkbox.checked = completed;

    const span = document.createElement("span");
    span.textContent = taskText;

    checkbox.addEventListener("change", () => {
      if (checkbox.checked) {
        li.classList.add("line-through", "bg-green-800", "bg-opacity-30");
      } else {
        li.classList.remove("line-through", "bg-green-800", "bg-opacity-30");
      }
      saveTasks();
    });

    if (completed) {
      li.classList.add("line-through", "bg-green-800", "bg-opacity-30");
    }

    label.appendChild(checkbox);
    label.appendChild(span);

    const btn = document.createElement("button");
    btn.innerHTML = "❌";
    btn.className = "text-red-400 hover:text-red-300 transition";
    btn.onclick = () => {
      list.removeChild(li);
      saveTasks();
    };

    li.appendChild(label);
    li.appendChild(btn);

    list.appendChild(li);
    input.value = "";
    saveTasks();
  }

  document.getElementById("new-task").addEventListener("keydown", function(e) {
    if (e.key === "Enter") {
      addTask();
    }
  });

  // Load saved tasks
  const savedTasks = JSON.parse(localStorage.getItem("tasks") || "[]");
  savedTasks.forEach(task => addTask(task.text, task.completed));

  // ========== LOFI MUSIC LOGIC ==========
  const lofiPlayer = document.getElementById("lofi-player");
  const playlistContainer = document.getElementById("lofi-playlist");
  const nowPlaying = document.getElementById("now-playing");

  async function loadLofiTracks() {
    try {
      const response = await fetch("https://api.lofipay.com/v1/lofi ");
      const data = await response.json();
      const tracks = data.data;

      playlistContainer.innerHTML = "";

      tracks.forEach((track, index) => {
        const li = document.createElement("li");
        const button = document.createElement("button");
        button.textContent = `${index + 1}. ${track.title} - ${track.artist}`;
        button.className = "w-full text-left px-3 py-2 rounded-md bg-gray-800 hover:bg-gray-700 transition";
        button.onclick = () => playLofiTrack(track.url, track.title, track.artist);
        li.appendChild(button);
        playlistContainer.appendChild(li);
      });
    } catch (err) {
      console.error("Failed to load lofi tracks:", err);
      playlistContainer.innerHTML = "<p class='text-center text-red-400'>Error loading tracks</p>";
    }
  }

  function playLofiTrack(url, title, artist) {
    lofiPlayer.src = url;
    lofiPlayer.play();
    lofiPlayer.classList.remove("hidden");
    nowPlaying.textContent = `Now Playing: "${title}" by ${artist}`;
  }

  // ========== INIT ==========
  updateWorkDisplay();
  updateBreakDisplay();
  loadLofiTracks();
  document.getElementById("year").textContent = new Date().getFullYear();
</script>

</body>
</html>